define(function(e){var t=e("angularjs"),n=e("./common"),i=e("./service"),r=t.module("TodoApp",[]);return r.service("todoService",i),r.directive("ngBlur",function(){return function(e,t,n){t.bind("blur",function(){e.$apply(n.ngBlur)})}}),r.controller("MainCtrl",["$scope","todoService",function(e,i){e.todoService=i,e.title="todo",e.todos=i.getTodos(),e.newTodo="",e.activeFilter={completed:""},e.remaining=0,e.hidden=!1,e.toggleAll=function(){this.hidden=!this.hidden},e.createOnEnter=function(e){e.which===n.ENTER_KEY&&this.newTodo.trim()&&(this.todoService.addTodo(this.newTodo),this.newTodo="")},e.$watch("todos",function(){var t=0;e.todos.forEach(function(e){e.completed||t++}),e.remaining=t,e.completed=e.todos.length-t,e.todoService.store()},!0),e.filter=function(e){this.activeFilter.completed=e},e.selected=function(t){return t===e.activeFilter.completed},e.getTodos=function(){return i.getTodos(this.activeFilter)},e.edit=function(e,n){e.edit=!0,setTimeout(function(){t.element(n.target).parent().next()[0].focus()},0)},e.close=function(e){e.edit=!1}}]),{init:function(){t.bootstrap(document.body,["TodoApp"])}}});