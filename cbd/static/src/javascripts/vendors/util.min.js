define(function(e,t,n){function i(e,t){if(t=t||"string","string"!=typeof t)throw Error("type must be string");return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()}var r=e("jquery"),o=e("underscore"),a=[40,60,80,100,120,160,180,200,240,250,300,310,320,360,400,460,600],s=Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"),l=304,u={};u.TPL={templates:{},loadTemplates:function(e,t){if(i(e,"string")&&(e=[e]),!i(e,"array"))throw Error("templateName must be array or string");var n=this,o=e.length,a=function(i){var s=e[i];void 0===n.templates[s]?r.get("./static/src/javascripts/tpls/"+s+".html",function(e){n.templates[s]=e,o>++i?a(i):t()}):o>++i?a(i):t()};a(0)},get:function(e){return this.templates[e]}},u.WaterFall=function(e){this.col=e,this.water=[],this.init()},u.WaterFall.prototype.init=function(){for(var e=this.col,t=0;e>t;t++)this.water[t]=0},u.WaterFall.prototype.getMinIndex=function(){return o.indexOf(this.water,o.min(this.water))},u.WaterFall.prototype.getMaxIndex=function(){return o.indexOf(this.water,o.max(this.water))},u.WaterFall.prototype.pushItem=function(e){var t=this;return t.water[t.getMinIndex()]+=e,t.water},u.WaterFall.prototype.getParam=function(){return{col:this.col,water:this.water}},u.WaterFall.prototype.makeColHtml=function(){for(var e="",t=0;this.col>t;t++){var n="waterCol";0===t?n+=" firstCol":t===this.col-1&&(n+=" lastedCol"),e+='<div class="'+n+'"></div>'}return e},u.Date={getEnglishMonth:function(e){return s[e]},getDate:function(e,t){e=e||"/",t=t||0;var n=(new Date).getTime();return n=new Date(n+1e3*60*60*24*t),n.getFullYear()+e+(1+n.getMonth())+e+n.getDate()}},u.TRANSFORM={translate3d:function(e,t,n){e=r(e),n=n||0,t=r.extend({x:0,y:0,z:0},t);var i=e[0].style;i&&(i.MozTransitionDuration=i.msTransitionDuration=i.OTransitionDuration=i.transitionDuration=n+"ms",i.webkitTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)",i.msTransform=i.MozTransform=i.OTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)")}},u.LOAD={show:function(){r("#gloabLoading").stop(!0,!0).fadeIn()},hide:function(){r("#gloabLoading").stop(!0,!0).fadeOut()}},u.getWaterFalColWidth=function(){return l},u.setWaterFalColWidth=function(e){l=e},u.OS={detect:function(e){var t=this.os={},n=this.browser={},i=e.match(/WebKit\/([\d.]+)/),r=e.match(/(Android)\s+([\d.]+)/),o=e.match(/(iPad).*OS\s([\d_]+)/),a=!o&&e.match(/(iPhone\sOS)\s([\d_]+)/),s=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),l=s&&e.match(/TouchPad/),u=e.match(/Kindle\/([\d.]+)/),c=e.match(/Silk\/([\d._]+)/),d=e.match(/(BlackBerry).*Version\/([\d.]+)/),h=e.match(/(BB10).*Version\/([\d.]+)/),f=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),p=e.match(/PlayBook/),g=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);return(n.webkit=!!i)&&(n.version=i[1]),r&&(t.android=!0,t.version=r[2]),a&&(t.ios=t.iphone=!0,t.version=a[2].replace(/_/g,".")),o&&(t.ios=t.ipad=!0,t.version=o[2].replace(/_/g,".")),s&&(t.webos=!0,t.version=s[2]),l&&(t.touchpad=!0),d&&(t.blackberry=!0,t.version=d[2]),h&&(t.bb10=!0,t.version=h[2]),f&&(t.rimtabletos=!0,t.version=f[2]),p&&(n.playbook=!0),u&&(t.kindle=!0,t.version=u[1]),c&&(n.silk=!0,n.version=c[1]),!c&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),g&&(n.chrome=!0,n.version=g[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(o||p||r&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!(t.tablet||!(r||a||s||d||h||g&&e.match(/Android/)||g&&e.match(/CriOS\/([\d.]+)/)||m&&e.match(/Mobile/))),{os:t,browser:n}}},u.URL={getHash:function(){var e=window.location.hash,t="";return e&&(t=e.slice(1),t=t.split("/")),t}},u.TOOL={getPicSize:function(){for(var e=u.getWaterFalColWidth(),t=a[0],n=1,i=a.length;i>n;n++)if(a[n]>=e){t=a[n];break}return t}},n.exports=u});